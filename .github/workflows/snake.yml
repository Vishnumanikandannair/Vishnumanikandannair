name: üêç Generate Multiple Snake Themes

on:
  schedule:
    - cron: "0 */8 * * *" # runs every 8 hours
  workflow_dispatch:

permissions:
  contents: write

env:
  USERNAME: "Vishnumanikandannair"
  OUT_DIR: "dist"

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Generate Snake Variants
        uses: Platane/snk/svg-only@v3
        with:
          github_user_name: ${{ env.USERNAME }}
          outputs: |
            ${{ env.OUT_DIR }}/snake-dark.svg?palette=github-dark&speed=120&date_format=%b%20%d,%Y
            ${{ env.OUT_DIR }}/snake-hacker.svg?palette=github-dark&color_snake=#00FF41&speed=150
            ${{ env.OUT_DIR }}/snake-light.svg?palette=github-light&speed=110
            ${{ env.OUT_DIR }}/snake-blue.svg?palette=github&speed=140&color_snake=cyan

      - name: Ensure output branch exists
        run: |
          git fetch origin output || true
          if ! git ls-remote --heads origin output; then
            git checkout --orphan output
            git reset --hard
            echo "üêç Output branch created automatically." > README.md
            git add README.md
            git config user.name "github-actions"
            git config user.email "github-actions@github.com"
            git commit -m "Initialize output"
            git push origin output
          fi

      - name: Push Snake Files to Output Branch
        run: |
          git checkout output
          cp ${{ env.OUT_DIR }}/* .
          git add .
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git commit -m "üêç Updated snake graphics ($(date '+%Y-%m-%d %H:%M:%S'))" || true
          git push origin output
